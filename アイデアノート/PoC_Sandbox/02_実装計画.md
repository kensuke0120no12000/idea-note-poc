# PoC実装計画：動的知覚・推論システム

## 1. PoCの目的

本プロジェクト構想で定義した「二重ループ・アーキテクチャ」の技術的な実現可能性を検証し、主要な課題を洗い出すことを目的とする。
このPoCでは、まず中核となる**「戦術ループ」**の最低限の機能を実装することに焦点を当てる。

## 2. 対象スコープ

*   **IN**:
    *   ダミーのイベント生成機能
    *   イベントログ（キャッシュ）を記録する機能
    *   手動で作成したナレッジベース
    *   ナレッジベースを参照して推論を行うRAGシステム
    *   上記を統合し、一連の流れとして動作する基本的なアプリケーション
*   **OUT**:
    *   実際のYOLO-WORLDとの連携
    *   戦略ループ（3エージェントによる学習機能）の完全な実装
    *   複雑なアクション実行機能
    *   Web UIなどのフロントエンド

## 3. 技術スタック

*   **プログラミング言語**: Python 3.11+
*   **APIフレームワーク**: FastAPI
*   **RAG・LLM連携**: LangChain
*   **データベース**: SQLite (SQLAlchemyを使用)
*   **依存関係管理**: pip / requirements.txt

## 4. 実装ステップ

### Step 1: プロジェクト基盤のセットアップ
1.  **ディレクトリ構造の作成**: `app`, `data`, `tests` などの基本的なディレクトリを作成する。
2.  **依存関係ファイルの作成**: `requirements.txt` を作成し、必要なライブラリ（fastapi, uvicorn, langchain, sqlalchemyなど）を定義する。
3.  **初期設定**: 仮想環境の構築手順などを記した、簡単な`README.md`を作成する。

### Step 2: データモデルの定義
1.  **データベースモデルの定義**: SQLAlchemyを使い、「イベントログ」を保存するためのテーブル構造を定義する。
2.  **Pydanticモデルの定義**: APIでやり取りするデータの型を、Pydanticモデルとして定義する。

### Step 3: 戦術ループのコンポーネント実装
1.  **イベント生成器の実装**: 定期的にダミーのイベントデータ（JSON）を生成するモジュールを作成する。
2.  **バリデーターとロガーの実装**: イベントを受け取り、検証（今回はダミー）し、SQLiteデータベースに記録するロジックを実装する。
3.  **ナレッジベースの準備**: 手動で数件のマークダウンファイルを作成し、`data/knowledge_base`ディレクトリに配置する。
4.  **推論エンジン（RAG）の実装**:
    *   ナレッジベースのディレクトリを読み込むDocument Loaderを実装する。
    *   読み込んだドキュメントをベクトル化し、インデックスを作成する。
    *   入力（イベント情報）に対して、関連するナレッジを検索し、LLMに渡して応答を生成するチェーンを構築する。

### Step 4: 統合とAPI化
1.  **APIエンドポイントの作成**: FastAPIを使い、外部からイベントを投入するためのエンドポイント（例: `/events/`)を作成する。
2.  **全体の統合**: イベント投入エンドポイントが叩かれたら、バリデーター→ロガー→推論エンジンという一連の流れが実行されるように、各コンポーネントを結合する。

### Step 5: テストとドキュメンテーション
1.  **簡単なテストの記述**: 各コンポーネントが意図通りに動作するか、簡単なユニットテストを作成する。
2.  **コードのドキュメント化**: 各関数の役割などを、Docstring形式で記述する。 